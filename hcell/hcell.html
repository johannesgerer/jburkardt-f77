<html>

  <head>
    <title>
      HCELL - Fluid Flow in an H-shaped Region
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      HCELL <br> Fluid Flow in an H-shaped Region
    </h1>

    <hr>

    <p>
      <b>HCELL</b>
      is a FORTRAN77 program which
      solves the time-dependent Navier Stokes equations in a
      two-dimensional region called the "H Cell".
    </p>

    <p>
      As time increases, other flow parameters may be varied as well.
      For this code, the flow parameter that can vary is the magnitude
      of the inflow specified at the left boundary.
      The program stores the results of each timestep in a file.
      Each solution may be thought of as a "snapshot" of the gradual
      evolution of the flow field over time.
      In a typical run, 500 such files might be created.  One set of
      such data is stored as
      <a href = "../../datasets/tcell_flow/tcell_flow.html">
      the TCELL flow dataset</a>.
    </p>

    <p>
      A collection of snapshot files may be analyzed to seek a small
      underlying basis of fundamental flows.  This basis may be used
      to approximate the entire set, or indeed to generate a reduced basis
      program that can quickly and cheaply compute new flow solutions
      whose flow parameters vary in small ways from those of the original
      set.  Programs that can be used for such an analysis include
      <a href = "../../f_src/cvt_basis/cvt_basis.html">
      CVT_BASIS</a> and
      <a href = "../../f_src/pod_basis/pod_basis.html">
      POD_BASIS.</a>
    </p>

    <p>
      The "H-Cell" region is an H-shaped region.
      <pre>

          +----------------------------+
          |              :     :       |
    row 3 |   (3,1)      :(3,2): (3,3) |
          |              :     :       |
          +--------------+.....+-------+
                         |     |
    row 2     empty      |(2,2)|  empty
                         |     |
          +--------------+.....+-------+
          |              :     :       |
    row 1 |   (1,1)      :(1,2): (1,3) |
          |              :     :       |
          +----------------------------+

              col 1       col 2  col 3
      </pre>
    </p>

    <h3 align = "center">
      Usage:
    </h3>

    <p>
      <dl>
        <dt>
          hcell
        </dt>
        <dd>
          runs the program, reading the file "up000.txt" for
          the initial values of the horizontal and vertical
          velocities, and the pressure, at each node.  Output files
          include the series "up001.txt", "up002.txt" and so on,
          containing flow quantities at successive time steps.
        </dd>
      </dl>
    </p>

    <h3 align = "center">
      Author:
    </h3>

    <p>
      Hyun-Chun Lee, <br>
      Ajou University, Korea,<br>
      in collaboration
      with Max Gunzburger, Janet Peterson, and John Burkardt.
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files described and made available on this web page
      are distributed under
      <a href = "../../txt/gnu_lgpl.txt">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Related Data and Programs:
    </h3>

    <p>
      <a href = "../../f_src/bump/bump.html">
      BUMP</a>,
      a FORTRAN90 program which
      solves a fluid flow problem
      in a channel including a bump which obstructs and redirects the flow.
    </p>

    <p>
      <a href = "../../f_src/cvt_basis_flow/cvt_basis_flow.html">
      CVT_BASIS_FLOW</a>,
      a FORTRAN90 program which
      extracts dominant solution modes from a set of flow solutions
      using CVT methods.
    </p>

    <p>
      <a href = "../../m_src/hcell_flow_display/hcell_flow_display.html">
      HCELL_FLOW_DISPLAY</a>,
      a MATLAB program which
      can plot the data
      produced by <b>HCELL</b>.
    </p>

    <p>
      <a href = "../../f77_src/hcell_steady/hcell_steady.html">
      HCELL_STEADY</a>,
      a FORTRAN77 program which
      solves the time-independent
      or "steady" Navier Stokes equations in an H-cell region.
    </p>

    <p>
      <a href = "../../f77_src/inout/inout.html">
      INOUT</a>,
      a FORTRAN77 program which
      solves the Navier Stokes equations in the "In-Out" region.
    </p>

    <p>
      <a href = "../../f_src/mhd_control/mhd_control.html">
      MHD_CONTROL</a>,
      a FORTRAN90 program which
      tries to control the evolution of an MHD system so that a particular
      state is achieved.
    </p>

    <p>
      <a href = "../../f_src/mhd_flow/mhd_flow.html">
      MHD_FLOW</a>,
      a FORTRAN90 program which
      models the evolution of an MHD system.
    </p>

    <p>
      <a href = "../../cpp_src/nast2d/nast2d.html">
      NAST2D</a>,
      a C++ program which
      computes the pressure
      and velocity for a Navier Stokes flow.
    </p>

    <p>
      <a href = "../../f77_src/tcell/tcell.html">
      TCELL</a>
      a FORTRAN77 program which
      solves the Navier Stokes equations in the T-Cell region.
    </p>

    <p>
      <a href = "../../f_src/pod_basis_flow/pod_basis_flow.html">
      POD_BASIS_FLOW</a>,
      a FORTRAN90 program which
      extracts dominant solution modes from a set of flow solutions
      using POD methods.
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Max Gunzburger,<br>
          Finite Element Methods for Viscous Incompressible Flows,<br>
          A Guide to Theory, Practice, and Algorithms,<br>
          Academic Press, 1989,<br>
          ISBN: 0-12-307350-2,<br>
          LC: TA357.G86.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "hcell.f">hcell.f</a>, an initial draft of the
          program, with no treatment of the boundary conditions.
        </li>
        <li>
          <a href = "hcell.sh">hcell.sh</a>,
          commands to compile, link and load the source code.
        </li>
        <li>
          <a href = "hregion_01.f">hregion_01.f</a>,
          a first complete draft of the program.
        </li>
        <li>
          <a href = "hregion_02.f">hregion_02.f</a>,
          a second draft which includes setting one reference pressure,
          and a correction to the inflow/outflow boundary conditions.
        </li>
        <li>
          <a href = "hregion_03.f">hregion_03.f</a>,
          draft #3 includes a routine to write velocities to a
          TECPLOT file.
        </li>
        <li>
          <a href = "hregion_03.sh">hregion_03.sh</a>,
          commands to compile, link and load the program.
        </li>
        <li>
          <a href = "hregion_03_output.txt">hregion_03_output.txt</a>,
          printed output from a run of the program.
        </li>
        <li>
          <a href = "hregion_04.f">hregion_04.f</a>,
          draft #4 included corrections to the UBDRY routine,
          which fixed an outlet that wasn't letting out, and
          dropped an extra pressure condition that was accidentally
          causing problems in the velocity equation in the extreme
          upper right node.
        </li>
        <li>
          <a href = "hregion_04.sh">hregion_04.sh</a>,
          commands to compile, link and load the program.
        </li>
        <li>
          <a href = "hregion_04_output.txt">hregion_04_output.txt</a>,
          printed output from a run of the program.
        </li>
        <li>
          <a href = "hregion_05.f">hregion_05.f</a>,
          draft #5 implements the refinement scheme by setting
          NREFINE as a parameter, and computing all other variables
          directly from there.
        </li>
        <li>
          <a href = "hregion_05.sh">hregion_05.sh</a>,
          commands to compile, link and load the program.
        </li>
      </ul>
    </p>

    <h3 align = "center">
      Examples and Tests:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "xy3.txt">xy3.txt</a>,
          the coordinates of the nodes associated with linear elements;
        </li>
        <li>
          <a href = "xy6.txt">xy6.txt</a>,
          the coordinates of the nodes associated with quadratic elements;
        </li>
        <li>
          <a href = "uv000.txt">up000.txt</a>,
          a text file containing data to be used as the initial value
          of the solution;
        </li>
        <li>
          <a href = "p100.txt">p100.txt</a>,
          a file of pressure information at time step 100, suitable for
          plotting with "xy3.txt" and HCELL_CONTOUR_PLOT;
        </li>
        <li>
          <a href = "uv100.txt">uv100.txt</a>,
          a file of velocity information at time step 100, suitable for
          plotting with "xy6.txt" and HCELL_VECTOR_PLOT;
        </li>
        <li>
          <a href = "uv100.tec">uv100.tec</a>,
          a TECPLOT file containing the velocities at time step 100;
        </li>
      </ul>
    </p>

    <p>
      There are six sets of inflow and outflow vents in the flow region.
      A basis flow profile is specified for each set of vents.  However,
      for each vent group <b>I</b>, there is also a multiplier </b>BETA(I)</b>
      which can be used to modulate the flow strength.  To perform
      parameter studies, it was decided to consider datasets, each of
      which contained seven different settings for all the <b>BETA</b>'s.
      (Thus, such a dataset contains 42 numbers.)  Datasets were generated
      in a variety of ways:
      <ul>
        <li>
          <a href = "canon_06_07.txt">canon_06_07.txt</a>,
          the "canonical basis vectors", plus a vector which is entirely 1;
        </li>
        <li>
          <a href = "cvt_06_07.txt">cvt_06_07.txt</a>,
          a set generated by
          <a href = "../../f_src/cvt_dataset/cvt_dataset.html">
          CVT_DATASET</a>;
        </li>
        <li>
          <a href = "ham_06_07.txt">ham_06_07.txt</a>,
          a set generated by
          <a href = "../../f_src/hammersley_dataset/hammersley_dataset.html">
          HAMMERSLEY_DATASET</a>;
        </li>
        <li>
          <a href = "lcen_06_07.txt">lcen_06_07.txt</a>,
          a set generated by
          <a href =
          "../../f_src/latin_center_dataset/latin_center_dataset.html">
          LATIN_CENTER_DATASET</a>;
        </li>
        <li>
          <a href = "lcvt_06_07.txt">lcvt_06_07.txt</a>,
           a "latinized CVT" set generated by applying the
          <a href = "../../cpp_src/latinize/latinize.html">
          LATINIZE</a> program to the CVT_06_07.TXT file;
        </li>
        <li>
          <a href = "uni_06_07.txt">uni_06_07.txt</a>,
          a set generated by
          <a href = "../../f_src/uniform_dataset/uniform_dataset.html">
          UNIFORM_DATASET</a>;
        </li>
        <li>
          <a href = "uni_06_10.txt">uni_06_10.txt</a>,
          a set of 10 points, generated by
          <a href = "../../f_src/uniform_dataset/uniform_dataset.html">
          UNIFORM_DATASET</a>, and using a different seed;
        </li>
      </ul>
    </p>

    <h3 align = "center">
      List of Routines:
    </h3>

    <p>
      <ul>
        <li>
          <b>MAIN</b> is the main program for HCELL.
        </li>
        <li>
          <b>CH_IS_DIGIT</b> returns .TRUE. if a character is a decimal digit.
        </li>
        <li>
          <b>CH_TO_DIGIT</b> returns the integer value of a base 10 digit.
        </li>
        <li>
          <b>DAXPY</b> adds a multiple of one vector to another.
        </li>
        <li>
          <b>DDOT</b> forms the dot product of two vectors.
        </li>
        <li>
          <b>DGBFA</b> factors a double precision band matrix by elimination.
        </li>
        <li>
          <b>DGBSL</b> solves a double precision band linear system.
        </li>
        <li>
          <b>DGEFA</b> factors a double precision matrix by gaussian elimination.
        </li>
        <li>
          <b>DGESL</b> solves the double precision system
        </li>
        <li>
          <b>DIGIT_INC</b> increments a decimal digit.
        </li>
        <li>
          <b>DIGIT_TO_CH</b> returns the character representation of a decimal digit.
        </li>
        <li>
          <b>DSCAL</b> scales a vector by a constant.
        </li>
        <li>
          <b>ELEMENT_NODE_BANDWIDTH</b> determines the bandwidth associated with the grid.
        </li>
        <li>
          <b>ELEMENT_NODE_WRITE</b> writes the element node list to a file.
        </li>
        <li>
          <b>FILE_NAME_INC</b> generates the next file name in a series.
        </li>
        <li>
          <b>HCELL_DOF_COUNT</b> determines the number of degrees of freedom in the region.
        </li>
        <li>
          <b>HCELL_DOF_SET</b> assigns degrees of freedom to each node.
        </li>
        <li>
          <b>HCELL_ELEMENT_COUNT</b> determines the number of elements in the region.
        </li>
        <li>
          <b>HCELL_ELEMENT_NODE</b> determines the nodes that make up each element.
        </li>
        <li>
          <b>HCELL_NODE_NUM</b> determines the number of nodes in the region.
        </li>
        <li>
          <b>HCELL_NODE_XY</b> assigns coordinates to each node.
        </li>
        <li>
          <b>IDAMAX</b> finds the vector element of largest magnitude.
        </li>
        <li>
          <b>NODE_EPS</b> creates an EPS file containing an image of the nodes.
        </li>
        <li>
          <b>NSTOKE</b> solves the Navier-Stokes equations using Taylor-Hood elements.
        </li>
        <li>
          <b>P_WRITE</b> writes the pressures values for a given timestep to a file.
        </li>
        <li>
          <b>QUAD_A_SET</b> sets quadrature information for the assembly routine.
        </li>
        <li>
          <b>R8_HUGE</b> returns a "huge" double precision number.
        </li>
        <li>
          <b>REFBSP</b> evaluates a linear basis functions on the reference triangle.
        </li>
        <li>
          <b>REFQBF</b> evaluates quadratic basis functions on the reference triangle.
        </li>
        <li>
          <b>SETGRD</b> sets up the grid for the problem.
        </li>
        <li>
          <b>TRANS</b> transforms data between the reference and physical elements.
        </li>
        <li>
          <b>UBDRY</b> evaluates the boundary conditions.
        </li>
        <li>
          <b>UV_READ</b> returns an initial value for the solution coefficient vector.
        </li>
        <li>
          <b>UV_WRITE</b> writes the velocity values for a given timestep to a file.
        </li>
        <li>
          <b>XY3_WRITE</b> writes the coordinates of nodes of 3-node triangles to a file.
        </li>
        <li>
          <b>XY6_WRITE</b> writes the coordinates of nodes of 6-node triangles to a file.
        </li>
      </ul>
    </p>

    <p>
      You can go up one level to <a href = "../f77_src.html">
      the FORTRAN77 source codes</a>.
    </p>

    <hr>

    <i>
      Last revised on 13 November 2006.
    </i>

    <!-- John Burkardt -->

  </body>

  <!-- Initial HTML skeleton created by HTMLINDEX. -->

</html>
